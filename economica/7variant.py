from tabulate import tabulate

data = {
    "Вид оборотных средств": [
        "Промышленно-производственный персонал",
        "В том числе руководители",
        "В том числе специалисты",
        "В том числе рабочие",
        "Непромышленный персонал",
        "Всего"
    ],
    "Базисный год (тыс. руб.)": [1171, 39, 244, 888, 23, None],
    "Базисный год (% к итогу)": [None, None, None, None, None, 100],
    "Отчетный год (тыс. руб.)": [1512, 47, 320, 1145, 28, None],
    "Отчетный год (% к итогу)": [None, None, None, None, None, 100],
    "Относительное отклонение": [None, None, None, None, None, None]
}

# стр всего
total_base = sum(data["Базисный год (тыс. руб.)"][:-1])  # Сумма всех значений, кроме строки "Всего"
total_report = sum(data["Отчетный год (тыс. руб.)"][:-1])

# общие суммы в стр всего
data["Базисный год (тыс. руб.)"][-1] = total_base
data["Отчетный год (тыс. руб.)"][-1] = total_report

# проценты к итогу и отклонения
for i in range(len(data["Вид оборотных средств"]) - 1):
    # Б год
    base_value = data["Базисный год (тыс. руб.)"][i]
    percent_base = (base_value / total_base) * 100
    data["Базисный год (% к итогу)"][i] = round(percent_base, 2)

    # О год
    report_value = data["Отчетный год (тыс. руб.)"][i]
    percent_report = (report_value / total_report) * 100
    data["Отчетный год (% к итогу)"][i] = round(percent_report, 2)

    # отклонение
    deviation = ((report_value - base_value) / base_value) * 100
    data["Относительное отклонение"][i] = round(deviation, 2)

data["Относительное отклонение"][-1] = 0

table_data = []
for i in range(len(data["Вид оборотных средств"])):
    row = [
        data["Вид оборотных средств"][i],
        data["Базисный год (тыс. руб.)"][i],
        data["Базисный год (% к итогу)"][i],
        data["Отчетный год (тыс. руб.)"][i],
        data["Отчетный год (% к итогу)"][i],
        data["Относительное отклонение"][i]
    ]
    table_data.append(row)

# Заголовки столбцов
headers = [
    "Вид оборотных средств",
    "Базисный год (тыс. руб.)",
    "Базисный год (% к итогу)",
    "Отчетный год (тыс. руб.)",
    "Отчетный год (% к итогу)",
    "Относительное отклонение"
]

# Вывод таблицы с использованием tabulate
print(tabulate(table_data, headers=headers, tablefmt="grid"))