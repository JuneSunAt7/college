from tabulate import tabulate
'''
Относительное отклонение= 
Базисный год (тыс. руб.) / Отчетный год (тыс. руб.)−Базисный год (тыс. руб.) ×100
'''
data = {
    "Вид оборотных средств": [
        "Запасы",
        "Незавершенное производство",
        "Расходы будущих периодов",
        "Готовая продукция",
        "Денежные средства",
        "Дебиторская задолженность",
        "Всего"
    ],
    "Базисный год (тыс. руб.)": [6586, 713, 4, 3545, 70, 2070, None],
    "Базисный год (% к итогу)": [None, None, None, None, None, None, 100],
    "Отчетный год (тыс. руб.)": [13374, 1760, 31, 6428, 204, 5818, None],
    "Отчетный год (% к итогу)": [None, None, None, None, None, None, 100],
    "Относительное отклонение": [None, None, None, None, None, None, None]
}

# стр всего
total_base = sum(data["Базисный год (тыс. руб.)"][:-1])  # Сумма всех значений, кроме строки "Всего"
total_report = sum(data["Отчетный год (тыс. руб.)"][:-1])

# общие суммы стр  всего
data["Базисный год (тыс. руб.)"][-1] = total_base
data["Отчетный год (тыс. руб.)"][-1] = total_report

# проценты к итогу и относ отклонения
for i in range(len(data["Вид оборотных средств"]) - 1):  # Искл стр всего
    # Б год
    base_value = data["Базисный год (тыс. руб.)"][i]
    percent_base = (base_value / total_base) * 100
    data["Базисный год (% к итогу)"][i] = round(percent_base, 2)

    # О год
    report_value = data["Отчетный год (тыс. руб.)"][i]
    percent_report = (report_value / total_report) * 100
    data["Отчетный год (% к итогу)"][i] = round(percent_report, 2)

    # отклонение
    if base_value != 0:
        deviation = ((report_value - base_value) / base_value) * 100
    else:
        deviation = 0
    data["Относительное отклонение"][i] = round(deviation, 2)

# задано явно
data["Относительное отклонение"][-1] = 112.6

table_data = []
for i in range(len(data["Вид оборотных средств"])):
    row = [
        data["Вид оборотных средств"][i],
        data["Базисный год (тыс. руб.)"][i],
        data["Базисный год (% к итогу)"][i],
        data["Отчетный год (тыс. руб.)"][i],
        data["Отчетный год (% к итогу)"][i],
        data["Относительное отклонение"][i]
    ]
    table_data.append(row)

headers = [
    "Вид оборотных средств",
    "Базисный год (тыс. руб.)",
    "Базисный год (% к итогу)",
    "Отчетный год (тыс. руб.)",
    "Отчетный год (% к итогу)",
    "Относительное отклонение"
]

# Вывод таблицы с использованием tabulate
print(tabulate(table_data, headers=headers, tablefmt="grid"))